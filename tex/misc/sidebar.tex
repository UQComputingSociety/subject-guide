\newlength\mylen
\newlength\mylena
\newarray\sectionicon
\readarray{sectionicon}{\faHome&\faList& \faAreaChart &\faDatabase& Ai &\faHome&\faHome}
\def\sectioncolour{{"gray","purple","blue", "red", "orange", "yellow"}}
\tikzset{
  tab/.style={
    text width=30mm,
    draw=gray,
    thick,
    rectangle,
    align=center,
    inner sep=0pt,
    fill=gray!20,
    font=\sffamily\LARGE
  }
}
\tikzset{
  selectedtab/.style={
    tab,
    color=white,
    fill=gray
  }
}

\AtBeginDocument{
  % calculation of the width for each tab
  \setlength\mylen{\paperheight}
  \ifnum\totvalue{section}>0
    \setlength\mylena{\dimexpr\mylen/\totvalue{section}\relax}
  \fi

  \backgroundsetup{
    scale=1,
    color=black,
    angle=0,
    opacity=1,
    contents= {
    \begin{tikzpicture}[
      remember picture,
      overlay,
    ]
    \ifnum\thesection>0
      \ifnum\totvalue{section}>0
        \node[inner sep=0pt]
            at (current page.center) (border) {
              \rule{0pt}{\dimexpr\textheight+2cm\relax}};
          \foreach \valsection in {0,...,\numexpr\totvalue{section}-1\relax} {%
            \pgfmathsetmacro{\sc}{\sectioncolour[\valsection]}
            \node[
              \ifnum\thesection<\numexpr\valsection+1\relax
                tab%
              \else
                \ifnum\thesection>\numexpr\valsection+1\relax
                  tab%
                \else
                  selectedtab%
                \fi
              \fi,
            minimum height=\mylena, fill=\sc, draw=\sc ]
                at ([yshift=-(0.5+\valsection)*\mylena]current page.north west)
                (tab-\valsection)
              {\hspace*{15mm}
                 {\hyperlink{sec:\valsection}{\sectionicon(\numexpr\valsection+1)}}};
          }
        \pgfmathsetmacro{\sc}{\sectioncolour[\numexpr\thesection-1]}
        \node[
          draw=\sc,
          line width=2pt,
          rectangle,
          inner sep=0pt,
          text width=4mm,
          fill=\sc
        ] at ([xshift=16mm]current page.west){\rule{0pt}{\paperheight}};
        \node[font=\LARGE\sffamily,fill=white] at (border.south){\makebox[3em][c]{\thepage}};
      \fi
    \fi
    \end{tikzpicture}}
  }
}